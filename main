WITH
  three_weeks_data AS (
  SELECT
    start_date,
    FORMAT_DATE( "%b-%d", start_date) AS date,
    FORMAT_DATE( "%a", start_date) AS day_of_week
  FROM
    `bigquery-public-data.san_francisco_bikeshare.bikeshare_trips`
  WHERE
    start_date BETWEEN '2018-04-08 00:00:00 UTC'
    AND '2018-04-29 00:00:00 UTC'
  ORDER BY
    start_date DESC )
SELECT
  date,
  day_of_week,
  COUNT (date) AS total_day_count
FROM
  three_weeks_data
GROUP BY
  date,
  day_of_week
